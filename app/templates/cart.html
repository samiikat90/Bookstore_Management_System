<!DOCTYPE html><!doctype html><!doctype html><!doctype html>

<html lang="en">

<head><html>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><head><html><html>

    <title>Shopping Cart - Bookstore</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">    <meta charset="utf-8">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

</head>    <title>Your Cart</title><head><head>

<body class="bg-light">

    <!-- Navigation Bar -->    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">

        <div class="container"></head>    <meta charset="utf-8">    <meta charset="utf-8">

            <a class="navbar-brand" href="{{ url_for('browse') }}">

                <i class="fas fa-book"></i> Bookstore<body class="bg-light">

            </a>

            <div class="container mt-4">    <title>Your Cart</title>    <title>Your Cart</title>

            <div class="navbar-nav ml-auto">

                {% if current_user.is_authenticated and current_user.email is defined %}    <h1>Your Cart</h1>

                    <!-- Logged in customer -->

                    <div class="nav-item dropdown">    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

                        <a class="nav-link dropdown-toggle" href="#" id="customerDropdown" role="button" data-toggle="dropdown">

                            <i class="fas fa-user"></i> {{ current_user.full_name }}    {% with messages = get_flashed_messages(with_categories=true) %}

                        </a>

                        <div class="dropdown-menu">      {% if messages %}</head></head>

                            <a class="dropdown-item" href="{{ url_for('customer_account') }}">

                                <i class="fas fa-user-circle"></i> My Account        {% for category, message in messages %}

                            </a>

                            <a class="dropdown-item" href="{{ url_for('customer_orders') }}">          <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert"><body class="bg-light"><body class="bg-light">

                                <i class="fas fa-shopping-bag"></i> My Orders

                            </a>            {{ message }}

                            <div class="dropdown-divider"></div>

                            <a class="dropdown-item" href="{{ url_for('customer_logout') }}">            <button type="button" class="close" data-dismiss="alert">&times;</button><div class="container mt-4"><div class="container mt-4">

                                <i class="fas fa-sign-out-alt"></i> Logout

                            </a>          </div>

                        </div>

                    </div>        {% endfor %}    <h1>Your Cart</h1>    <h1>Your Cart</h1>

                {% else %}

                    <!-- Guest user -->      {% endif %}

                    <a class="nav-link" href="{{ url_for('customer_login') }}">

                        <i class="fas fa-sign-in-alt"></i> Login    {% endwith %}

                    </a>

                    <a class="nav-link" href="{{ url_for('customer_register') }}">

                        <i class="fas fa-user-plus"></i> Register

                    </a>    {% if cart_items %}    {% with messages = get_flashed_messages(with_categories=true) %}    {% if cart_items %}

                {% endif %}

                    <table class="table table-bordered">

                <a class="nav-link active" href="{{ url_for('view_cart') }}">

                    <i class="fas fa-shopping-cart"></i> Cart         <thead>      {% if messages %}    <table class="table table-bordered">

                    <span class="badge badge-pill badge-light">{{ session['cart']|length if session.get('cart') else 0 }}</span>

                </a>            <tr>

            </div>

        </div>                <th>Title</th>        {% for category, message in messages %}        <thead>

    </nav>

                <th>Author</th>

    <div class="container mt-4">

        <div class="d-flex justify-content-between align-items-center mb-4">                <th>ISBN</th>          <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">            <tr>

            <h1><i class="fas fa-shopping-cart"></i> Shopping Cart</h1>

            <a href="{{ url_for('browse') }}" class="btn btn-outline-primary">                <th>Price</th>

                <i class="fas fa-arrow-left"></i> Continue Shopping

            </a>                <th>Quantity</th>            {{ message }}                <th>Title</th>

        </div>

                <th>Subtotal</th>

        <!-- Flash messages -->

        {% with messages = get_flashed_messages(with_categories=true) %}            </tr>            <button type="button" class="close" data-dismiss="alert">&times;</button>                <th>Author</th>

            {% if messages %}

                {% for category, message in messages %}        </thead>

                    <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show">

                        {{ message }}        <tbody>          </div>                <th>ISBN</th>

                        <button type="button" class="close" data-dismiss="alert">&times;</button>

                    </div>            {% for book, qty in cart_items %}

                {% endfor %}

            {% endif %}            <tr>        {% endfor %}                <th>Price</th>

        {% endwith %}

                <td>{{ book.title }}</td>

        {% if cart_items %}

            <!-- Cart Items Table -->                <td>{{ book.author }}</td>      {% endif %}                <th>Quantity</th>

            <div class="card mb-4">

                <div class="card-header">                <td>{{ book.isbn }}</td>

                    <h5><i class="fas fa-list"></i> Cart Items</h5>

                </div>                <td>${{ '%.2f'|format(book.price) }}</td>    {% endwith %}                <th>Subtotal</th>

                <div class="card-body p-0">

                    <div class="table-responsive">                <td>{{ qty }}</td>

                        <table class="table table-bordered mb-0">

                            <thead class="thead-light">                <td>${{ '%.2f'|format(book.price * qty) }}</td>            </tr>

                                <tr>

                                    <th>Title</th>            </tr>

                                    <th>Author</th>

                                    <th>ISBN</th>            {% endfor %}    {% if cart_items %}        </thead>

                                    <th>Price</th>

                                    <th>Quantity</th>        </tbody>

                                    <th>Subtotal</th>

                                    <th>Actions</th>        <tfoot>    <table class="table table-bordered">        <tbody>

                                </tr>

                            </thead>            <tr>

                            <tbody>

                                {% for book, qty in cart_items %}                <th colspan="5" class="text-right">Subtotal</th>        <thead>            {% for book, qty in cart_items %}

                                <tr>

                                    <td><strong>{{ book.title }}</strong></td>                <th>${{ '%.2f'|format(subtotal) }}</th>

                                    <td>{{ book.author }}</td>

                                    <td>{{ book.isbn }}</td>            </tr>            <tr>            <tr>

                                    <td>${{ '%.2f'|format(book.price) }}</td>

                                    <td>            {% if discount_amount > 0 %}

                                        <form method="POST" action="{{ url_for('update_cart', isbn=book.isbn) }}" class="d-inline">

                                            <input type="number" name="quantity" value="{{ qty }}" min="1" max="{{ book.quantity }}" class="form-control" style="width: 70px; display: inline-block;">            <tr class="table-success">                <th>Title</th>                <td>{{ book.title }}</td>

                                            <button type="submit" class="btn btn-sm btn-outline-primary ml-1">

                                                <i class="fas fa-sync"></i>                <th colspan="5" class="text-right">Discount ({{ discount_code }})</th>

                                            </button>

                                        </form>                <th>-${{ '%.2f'|format(discount_amount) }}</th>                <th>Author</th>                <td>{{ book.author }}</td>

                                    </td>

                                    <td><strong>${{ '%.2f'|format(book.price * qty) }}</strong></td>            </tr>

                                    <td>

                                        <form method="POST" action="{{ url_for('remove_from_cart', isbn=book.isbn) }}" class="d-inline">            {% endif %}                <th>ISBN</th>                <td>{{ book.isbn }}</td>

                                            <button type="submit" class="btn btn-sm btn-outline-danger">

                                                <i class="fas fa-trash"></i>            <tr class="table-info">

                                            </button>

                                        </form>                <th colspan="5" class="text-right"><strong>Total</strong></th>                <th>Price</th>                <td>${{ '%.2f'|format(book.price) }}</td>

                                    </td>

                                </tr>                <th><strong>${{ '%.2f'|format(total) }}</strong></th>

                                {% endfor %}

                            </tbody>            </tr>                <th>Quantity</th>                <td>{{ qty }}</td>

                        </table>

                    </div>        </tfoot>

                </div>

            </div>    </table>                <th>Subtotal</th>                <td>${{ '%.2f'|format(book.price * qty) }}</td>



            <!-- Cart Summary -->

            <div class="row">

                <div class="col-md-6">    <!-- Discount Code Section -->            </tr>            </tr>

                    <!-- Discount Code Section -->

                    <div class="card mb-3">    <div class="card mb-3">

                        <div class="card-header">

                            <h5><i class="fas fa-tags"></i> Discount Code</h5>        <div class="card-header">        </thead>            {% endfor %}

                        </div>

                        <div class="card-body">            <h5>Discount Code</h5>

                            {% if discount_code %}

                                <div class="alert alert-success">        </div>        <tbody>        </tbody>

                                    <strong>Active Discount:</strong> {{ discount_code }}

                                    <a href="{{ url_for('remove_discount') }}" class="btn btn-sm btn-outline-danger ml-2">        <div class="card-body">

                                        <i class="fas fa-times"></i> Remove

                                    </a>            {% if discount_code %}            {% for book, qty in cart_items %}        <tfoot>

                                </div>

                            {% else %}                <div class="alert alert-success">

                                <form method="POST" action="{{ url_for('apply_discount') }}">

                                    <div class="form-group">                    <strong>Active Discount:</strong> {{ discount_code }}             <tr>            <tr>

                                        <input type="text" name="discount_code" class="form-control" placeholder="Enter discount code">

                                    </div>                    <a href="{{ url_for('remove_discount') }}" class="btn btn-sm btn-outline-danger ml-2">Remove</a>

                                    <button type="submit" class="btn btn-outline-primary btn-block">

                                        <i class="fas fa-tag"></i> Apply Discount                </div>                <td>{{ book.title }}</td>                <th colspan="5" class="text-right">Total</th>

                                    </button>

                                </form>            {% else %}

                                

                                <hr>                <form action="{{ url_for('apply_discount') }}" method="post" class="form-inline">                <td>{{ book.author }}</td>                <th>${{ '%.2f'|format(total) }}</th>

                                <small class="text-muted">

                                    <strong>Available codes:</strong><br>                    <input type="text" name="discount_code" class="form-control mr-2" placeholder="Enter discount code" required>

                                    SAVE10, BOOK20, FALL25, STUDENT15, WINTER30

                                </small>                    <button type="submit" class="btn btn-success">Apply Discount</button>                <td>{{ book.isbn }}</td>            </tr>

                            {% endif %}

                        </div>                </form>

                    </div>

                </div>                <small class="form-text text-muted mt-2">                <td>${{ '%.2f'|format(book.price) }}</td>        </tfoot>



                <div class="col-md-6">                    Available codes: SAVE10 (10% off $30+), BOOK20 (20% off $50+), FALL25 (25% off $100+)

                    <!-- Order Summary -->

                    <div class="card">                </small>                <td>{{ qty }}</td>    </table>

                        <div class="card-header">

                            <h5><i class="fas fa-calculator"></i> Order Summary</h5>            {% endif %}

                        </div>

                        <div class="card-body">        </div>                <td>${{ '%.2f'|format(book.price * qty) }}</td>

                            <table class="table table-borderless">

                                <tr>    </div>

                                    <td>Subtotal:</td>

                                    <td class="text-right">${{ '%.2f'|format(subtotal) }}</td>            </tr>    <!-- Checkout form -->

                                </tr>

                                {% if discount_amount > 0 %}    <!-- Checkout form -->

                                <tr class="text-success">

                                    <td>Discount ({{ discount_code }}):</td>    <form action="{{ url_for('checkout') }}" method="post">            {% endfor %}    <form action="{{ url_for('checkout') }}" method="post">

                                    <td class="text-right">-${{ '%.2f'|format(discount_amount) }}</td>

                                </tr>        <button type="submit" class="btn btn-primary btn-lg">Complete Purchase</button>

                                {% endif %}

                                <tr class="border-top">    </form>        </tbody>        <button type="submit" class="btn btn-primary">Complete Purchase</button>

                                    <td><strong>Total:</strong></td>

                                    <td class="text-right"><strong>${{ '%.2f'|format(total) }}</strong></td>

                                </tr>

                            </table>    <!-- Continue shopping link -->        <tfoot>    </form>

                            

                            <form method="POST" action="{{ url_for('checkout') }}">    <a href="{{ url_for('browse') }}" class="btn btn-secondary">Continue Shopping</a>

                                <button type="submit" class="btn btn-success btn-block btn-lg">

                                    <i class="fas fa-credit-card"></i> Proceed to Checkout            <tr>

                                </button>

                            </form>    {% else %}

                        </div>

                    </div>    <div class="alert alert-info">                <th colspan="5" class="text-right">Subtotal</th>    <!-- Continue shopping link -->

                </div>

            </div>        <h4>Your cart is empty.</h4>



            <!-- Cart Actions -->        <p>Browse our collection to add books to your cart.</p>                <th>${{ '%.2f'|format(subtotal) }}</th>    <a href="{{ url_for('browse') }}" class="btn btn-secondary">Continue Shopping</a>

            <div class="text-center mt-4">

                <a href="{{ url_for('reset_cart') }}" class="btn btn-outline-danger">        <a href="{{ url_for('browse') }}" class="btn btn-primary">Start Shopping</a>

                    <i class="fas fa-trash-alt"></i> Clear Cart

                </a>    </div>            </tr>

            </div>

    {% endif %}

        {% else %}

            <!-- Empty Cart --></div>            {% if discount_amount > 0 %}    {% else %}

            <div class="text-center py-5">

                <i class="fas fa-shopping-cart fa-3x text-muted mb-3"></i>

                <h3 class="text-muted">Your cart is empty</h3>

                <p class="text-muted">Start browsing our books to add items to your cart.</p><script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>            <tr class="table-success">    <p>Your cart is empty.</p>

                <a href="{{ url_for('browse') }}" class="btn btn-primary btn-lg">

                    <i class="fas fa-book"></i> Browse Books<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>

                </a>

            </div></body>                <th colspan="5" class="text-right">Discount ({{ discount_code }})</th>    {% endif %}

        {% endif %}

    </div></html>

                <th>-${{ '%.2f'|format(discount_amount) }}</th></div>

    <!-- Bootstrap JS -->

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>            </tr></body>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>

</body>            {% endif %}</html>

</html>
            <tr class="table-info">
                <th colspan="5" class="text-right"><strong>Total</strong></th>
                <th><strong>${{ '%.2f'|format(total) }}</strong></th>
            </tr>
        </tfoot>
    </table>

    <!-- Discount Code Section -->
    <div class="card mb-3">
        <div class="card-header">
            <h5>Discount Code</h5>
        </div>
        <div class="card-body">
            {% if discount_code %}
                <div class="alert alert-success">
                    <strong>Active Discount:</strong> {{ discount_code }} 
                    <a href="{{ url_for('remove_discount') }}" class="btn btn-sm btn-outline-danger ml-2">Remove</a>
                </div>
            {% else %}
                <form action="{{ url_for('apply_discount') }}" method="post" class="form-inline">
                    <input type="text" name="discount_code" class="form-control mr-2" placeholder="Enter discount code" required>
                    <button type="submit" class="btn btn-success">Apply Discount</button>
                </form>
                <small class="form-text text-muted mt-2">
                    Available codes: SAVE10 (10% off $30+), BOOK20 (20% off $50+), FALL25 (25% off $100+)
                </small>
            {% endif %}
        </div>
    </div>

    <!-- Checkout form -->
    <form action="{{ url_for('checkout') }}" method="post">
        <button type="submit" class="btn btn-primary btn-lg">Complete Purchase</button>
    </form>

    <!-- Continue shopping link -->
    <a href="{{ url_for('browse') }}" class="btn btn-secondary">Continue Shopping</a>

    {% else %}
    <div class="alert alert-info">
        <h4>Your cart is empty.</h4>
        <p>Browse our collection to add books to your cart.</p>
        <a href="{{ url_for('browse') }}" class="btn btn-primary">Start Shopping</a>
    </div>
    {% endif %}
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>