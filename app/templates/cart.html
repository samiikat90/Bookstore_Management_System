<!doctype html><!doctype html><!doctype html>

<html>

<head><html><html>

    <meta charset="utf-8">

    <title>Your Cart</title><head><head>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

</head>    <meta charset="utf-8">    <meta charset="utf-8">

<body class="bg-light">

<div class="container mt-4">    <title>Your Cart</title>    <title>Your Cart</title>

    <h1>Your Cart</h1>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    {% with messages = get_flashed_messages(with_categories=true) %}

      {% if messages %}</head></head>

        {% for category, message in messages %}

          <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert"><body class="bg-light"><body class="bg-light">

            {{ message }}

            <button type="button" class="close" data-dismiss="alert">&times;</button><div class="container mt-4"><div class="container mt-4">

          </div>

        {% endfor %}    <h1>Your Cart</h1>    <h1>Your Cart</h1>

      {% endif %}

    {% endwith %}



    {% if cart_items %}    {% with messages = get_flashed_messages(with_categories=true) %}    {% if cart_items %}

    <table class="table table-bordered">

        <thead>      {% if messages %}    <table class="table table-bordered">

            <tr>

                <th>Title</th>        {% for category, message in messages %}        <thead>

                <th>Author</th>

                <th>ISBN</th>          <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">            <tr>

                <th>Price</th>

                <th>Quantity</th>            {{ message }}                <th>Title</th>

                <th>Subtotal</th>

            </tr>            <button type="button" class="close" data-dismiss="alert">&times;</button>                <th>Author</th>

        </thead>

        <tbody>          </div>                <th>ISBN</th>

            {% for book, qty in cart_items %}

            <tr>        {% endfor %}                <th>Price</th>

                <td>{{ book.title }}</td>

                <td>{{ book.author }}</td>      {% endif %}                <th>Quantity</th>

                <td>{{ book.isbn }}</td>

                <td>${{ '%.2f'|format(book.price) }}</td>    {% endwith %}                <th>Subtotal</th>

                <td>{{ qty }}</td>

                <td>${{ '%.2f'|format(book.price * qty) }}</td>            </tr>

            </tr>

            {% endfor %}    {% if cart_items %}        </thead>

        </tbody>

        <tfoot>    <table class="table table-bordered">        <tbody>

            <tr>

                <th colspan="5" class="text-right">Subtotal</th>        <thead>            {% for book, qty in cart_items %}

                <th>${{ '%.2f'|format(subtotal) }}</th>

            </tr>            <tr>            <tr>

            {% if discount_amount > 0 %}

            <tr class="table-success">                <th>Title</th>                <td>{{ book.title }}</td>

                <th colspan="5" class="text-right">Discount ({{ discount_code }})</th>

                <th>-${{ '%.2f'|format(discount_amount) }}</th>                <th>Author</th>                <td>{{ book.author }}</td>

            </tr>

            {% endif %}                <th>ISBN</th>                <td>{{ book.isbn }}</td>

            <tr class="table-info">

                <th colspan="5" class="text-right"><strong>Total</strong></th>                <th>Price</th>                <td>${{ '%.2f'|format(book.price) }}</td>

                <th><strong>${{ '%.2f'|format(total) }}</strong></th>

            </tr>                <th>Quantity</th>                <td>{{ qty }}</td>

        </tfoot>

    </table>                <th>Subtotal</th>                <td>${{ '%.2f'|format(book.price * qty) }}</td>



    <!-- Discount Code Section -->            </tr>            </tr>

    <div class="card mb-3">

        <div class="card-header">        </thead>            {% endfor %}

            <h5>Discount Code</h5>

        </div>        <tbody>        </tbody>

        <div class="card-body">

            {% if discount_code %}            {% for book, qty in cart_items %}        <tfoot>

                <div class="alert alert-success">

                    <strong>Active Discount:</strong> {{ discount_code }}             <tr>            <tr>

                    <a href="{{ url_for('remove_discount') }}" class="btn btn-sm btn-outline-danger ml-2">Remove</a>

                </div>                <td>{{ book.title }}</td>                <th colspan="5" class="text-right">Total</th>

            {% else %}

                <form action="{{ url_for('apply_discount') }}" method="post" class="form-inline">                <td>{{ book.author }}</td>                <th>${{ '%.2f'|format(total) }}</th>

                    <input type="text" name="discount_code" class="form-control mr-2" placeholder="Enter discount code" required>

                    <button type="submit" class="btn btn-success">Apply Discount</button>                <td>{{ book.isbn }}</td>            </tr>

                </form>

                <small class="form-text text-muted mt-2">                <td>${{ '%.2f'|format(book.price) }}</td>        </tfoot>

                    Available codes: SAVE10 (10% off $30+), BOOK20 (20% off $50+), FALL25 (25% off $100+)

                </small>                <td>{{ qty }}</td>    </table>

            {% endif %}

        </div>                <td>${{ '%.2f'|format(book.price * qty) }}</td>

    </div>

            </tr>    <!-- Checkout form -->

    <!-- Checkout form -->

    <form action="{{ url_for('checkout') }}" method="post">            {% endfor %}    <form action="{{ url_for('checkout') }}" method="post">

        <button type="submit" class="btn btn-primary btn-lg">Complete Purchase</button>

    </form>        </tbody>        <button type="submit" class="btn btn-primary">Complete Purchase</button>



    <!-- Continue shopping link -->        <tfoot>    </form>

    <a href="{{ url_for('browse') }}" class="btn btn-secondary">Continue Shopping</a>

            <tr>

    {% else %}

    <div class="alert alert-info">                <th colspan="5" class="text-right">Subtotal</th>    <!-- Continue shopping link -->

        <h4>Your cart is empty.</h4>

        <p>Browse our collection to add books to your cart.</p>                <th>${{ '%.2f'|format(subtotal) }}</th>    <a href="{{ url_for('browse') }}" class="btn btn-secondary">Continue Shopping</a>

        <a href="{{ url_for('browse') }}" class="btn btn-primary">Start Shopping</a>

    </div>            </tr>

    {% endif %}

</div>            {% if discount_amount > 0 %}    {% else %}



<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>            <tr class="table-success">    <p>Your cart is empty.</p>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>

</body>                <th colspan="5" class="text-right">Discount ({{ discount_code }})</th>    {% endif %}

</html>
                <th>-${{ '%.2f'|format(discount_amount) }}</th></div>

            </tr></body>

            {% endif %}</html>

            <tr class="table-info">
                <th colspan="5" class="text-right"><strong>Total</strong></th>
                <th><strong>${{ '%.2f'|format(total) }}</strong></th>
            </tr>
        </tfoot>
    </table>

    <!-- Discount Code Section -->
    <div class="card mb-3">
        <div class="card-header">
            <h5>Discount Code</h5>
        </div>
        <div class="card-body">
            {% if discount_code %}
                <div class="alert alert-success">
                    <strong>Active Discount:</strong> {{ discount_code }} 
                    <a href="{{ url_for('remove_discount') }}" class="btn btn-sm btn-outline-danger ml-2">Remove</a>
                </div>
            {% else %}
                <form action="{{ url_for('apply_discount') }}" method="post" class="form-inline">
                    <input type="text" name="discount_code" class="form-control mr-2" placeholder="Enter discount code" required>
                    <button type="submit" class="btn btn-success">Apply Discount</button>
                </form>
                <small class="form-text text-muted mt-2">
                    Available codes: SAVE10 (10% off $30+), BOOK20 (20% off $50+), FALL25 (25% off $100+)
                </small>
            {% endif %}
        </div>
    </div>

    <!-- Checkout form -->
    <form action="{{ url_for('checkout') }}" method="post">
        <button type="submit" class="btn btn-primary btn-lg">Complete Purchase</button>
    </form>

    <!-- Continue shopping link -->
    <a href="{{ url_for('browse') }}" class="btn btn-secondary">Continue Shopping</a>

    {% else %}
    <div class="alert alert-info">
        <h4>Your cart is empty.</h4>
        <p>Browse our collection to add books to your cart.</p>
        <a href="{{ url_for('browse') }}" class="btn btn-primary">Start Shopping</a>
    </div>
    {% endif %}
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>