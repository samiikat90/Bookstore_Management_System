{% extends "base_hero.html" %}

{% block title %}Order Details - {{ purchase.id }}{% endblock %}

{% block content %}
<div class="main-container">
 <div class="text-center mb-4">
 <h1 class="page-title">
 <i class="fas fa-receipt"></i> Order Details
 </h1>
 <p class="lead text-muted">Order #{{ purchase.id }} - {{ purchase.timestamp.strftime('%B %d, %Y at %I:%M %p') }}</p>
 </div>

 <div class="row">
 <div class="col-md-4">
 <!-- Navigation Sidebar -->
 <div class="card-hero mb-4">
 <div class="card-body">
 <h5 class="card-title text-center">
 <i class="fas fa-compass"></i> Navigation
 </h5>
 <div class="list-group list-group-flush">
 <a href="{{ url_for('customer_dashboard') }}" class="list-group-item list-group-item-action">
 <i class="fas fa-home"></i> Dashboard
 </a>
 <a href="{{ url_for('customer_orders') }}" class="list-group-item list-group-item-action">
 <i class="fas fa-arrow-left"></i> Back to Order History
 </a>
 <a href="{{ url_for('customer_account') }}" class="list-group-item list-group-item-action">
 <i class="fas fa-user"></i> Account Information
 </a>
 <a href="{{ url_for('customer_notifications') }}" class="list-group-item list-group-item-action">
 <i class="fas fa-bell"></i> Notifications
 </a>
 <a href="{{ url_for('catalog_view') }}" class="list-group-item list-group-item-action">
 <i class="fas fa-book-open"></i> Browse Catalog
 </a>
 </div>
 </div>
 </div>

 <!-- Order Status -->
 <div class="card-hero">
 <div class="card-body text-center">
 <h5 class="card-title">
 <i class="fas fa-info-circle"></i> Order Status
 </h5>
 
 <div class="mb-3">
 <h3>
 <span class="badge {{ purchase.get_status_badge_class() }}">
 <i class="{{ purchase.get_status_icon() }}"></i>
 {{ purchase.status }}
 </span>
 </h3>
 </div>
 
 <!-- Status Timeline -->
 <div class="timeline">
 <div class="timeline-item {% if purchase.status in ['Pending', 'Confirmed', 'Processing', 'Shipped', 'Delivered'] %}completed{% endif %}">
 <i class="fas fa-check-circle"></i>
 <span>Order Confirmed</span>
 </div>
 <div class="timeline-item {% if purchase.status in ['Processing', 'Shipped', 'Delivered'] %}completed{% endif %}">
 <i class="fas fa-cog"></i>
 <span>Processing</span>
 </div>
 <div class="timeline-item {% if purchase.status in ['Shipped', 'Delivered'] %}completed{% endif %}">
 <i class="fas fa-truck"></i>
 <span>Shipped</span>
 </div>
 <div class="timeline-item {% if purchase.status == 'Delivered' %}completed{% endif %}">
 <i class="fas fa-home"></i>
 <span>Delivered</span>
 </div>
 </div>
 </div>
 </div>
 </div>

 <div class="col-md-8">
 <!-- Order Details -->
 <div class="card-hero mb-4">
 <div class="card-body">
 <h4 class="card-title">
 <i class="fas fa-box"></i> Order Information
 </h4>
 
 <div class="row">
 <div class="col-md-6">
 <h6><i class="fas fa-hashtag"></i> Order Number</h6>
 <p class="text-muted">#{{ purchase.id }}</p>
 
 <h6><i class="fas fa-calendar"></i> Order Date</h6>
 <p class="text-muted">{{ purchase.timestamp.strftime('%B %d, %Y at %I:%M %p') }}</p>
 
 <h6><i class="fas fa-tag"></i> Order Status</h6>
 <p>
 <span class="badge {{ purchase.get_status_badge_class() }}">
 <i class="{{ purchase.get_status_icon() }}"></i>
 {{ purchase.status }}
 </span>
 </p>
 </div>
 <div class="col-md-6">
 <h6><i class="fas fa-user"></i> Customer Information</h6>
 <p class="text-muted">
 {{ purchase.customer_name }}<br>
 {{ purchase.customer_email }}<br>
 {% if purchase.customer_phone %}
 {{ purchase.customer_phone }}<br>
 {% endif %}
 {% if purchase.customer_address %}
 {{ purchase.customer_address }}
 {% endif %}
 </p>
 </div>
 </div>
 </div>
 </div>

 <!-- Book Details -->
 <div class="card-hero">
 <div class="card-body">
 <h4 class="card-title">
 <i class="fas fa-book"></i> Item Details
 </h4>
 
 {% if book %}
 <div class="row align-items-center">
 <div class="col-md-3 text-center">
 <i class="fas fa-book fa-4x text-muted mb-3"></i>
 </div>
 <div class="col-md-9">
 <h5>{{ book.title }}</h5>
 <p class="text-muted mb-2">
 <i class="fas fa-user"></i> <strong>Author:</strong> {{ book.author }}
 </p>
 <p class="text-muted mb-2">
 <i class="fas fa-layer-group"></i> <strong>Genre:</strong> {{ book.genre }}
 </p>
 <p class="text-muted mb-2">
 <i class="fas fa-barcode"></i> <strong>ISBN:</strong> {{ book.isbn }}
 </p>
 <p class="text-muted mb-2">
 <i class="fas fa-hashtag"></i> <strong>Quantity Ordered:</strong> {{ purchase.quantity }}
 </p>
 <p class="text-muted mb-2">
 <i class="fas fa-dollar-sign"></i> <strong>Unit Price:</strong> ${{ "%.2f"|format(book.price) }}
 </p>
 
 <div class="mt-3">
 <h5 class="text-success">
 <i class="fas fa-calculator"></i> 
 Total: ${{ "%.2f"|format(book.price * purchase.quantity) }}
 </h5>
 </div>
 
 {% if book.description %}
 <div class="mt-3">
 <h6>Description</h6>
 <p class="text-muted">{{ book.description }}</p>
 </div>
 {% endif %}
 </div>
 </div>
 {% else %}
 <div class="text-center py-4">
 <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
 <h5 class="text-muted">Book No Longer Available</h5>
 <p class="text-muted">
 <strong>ISBN:</strong> {{ purchase.book_isbn }}<br>
 <strong>Quantity:</strong> {{ purchase.quantity }}
 </p>
 </div>
 {% endif %}
 </div>
 </div>
 </div>
 </div>
</div>

<style>
.timeline {
 margin-top: 20px;
}

.timeline-item {
 display: flex;
 align-items: center;
 margin-bottom: 15px;
 color: #6c757d;
}

.timeline-item.completed {
 color: #28a745;
 font-weight: 600;
}

.timeline-item i {
 margin-right: 10px;
 width: 20px;
}

.timeline-item.completed i {
 color: #28a745;
}
</style>
{% endblock %}