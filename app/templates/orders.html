<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <title>Customer Orders</title>

 <!-- Bootstrap for styling -->
 <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
 <!-- Font Awesome for icons -->
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body class="bg-light">
 <div class="container mt-4">
 <div class="d-flex justify-content-between align-items-center mb-4">
 <h1 class="mb-0">Customer Orders</h1>
 <div>
 <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary mr-2">
 <i class="fas fa-arrow-left"></i> Back to Admin Dashboard
 </a>
 <a href="{{ url_for('logout') }}" class="btn btn-outline-danger">
 <i class="fas fa-sign-out-alt"></i> Log Out
 </a>
 </div>
 </div>

 <!-- Flash messages for status updates -->
 {% with messages = get_flashed_messages(with_categories=true) %}
 {% if messages %}
 {% for category, message in messages %}
 <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
 {{ message }}
 <button type="button" class="close" data-dismiss="alert">&times;</button>
 </div>
 {% endfor %}
 {% endif %}
 {% endwith %}

 <!-- Orders table -->
 {% if orders %}
 <table class="table table-bordered table-striped">
 <thead class="thead-dark">
 <tr>
 <th>Order ID</th>
 <th>Customer Name</th>
 <th>Contact Info</th>
 <th>Book ISBN</th>
 <th>Quantity</th>
 <th>Status</th>
 <th>Timestamp</th>
 </tr>
 </thead>
 <tbody>
 {% for order in orders %}
 <tr>
 <td>{{ order.id }}</td>
 <td>{{ order.customer_name }}</td>
 <td>
 {{ order.customer_email }}<br>
 {{ order.customer_phone }}<br>
 {{ order.customer_address }}
 </td>
 <td>{{ order.book_isbn }}</td>
 <td>{{ order.quantity }}</td>
 <td>
 <form method="POST" action="{{ url_for('update_order', order_id=order.id) }}">
 <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
 <div class="input-group">
 <select name="status" class="form-control form-control-sm">
 <option value="Pending" {% if order.status=='Pending' %}selected{% endif %}>Pending</option>
 <option value="Processing" {% if order.status=='Processing' %}selected{% endif %}>Processing</option>
 <option value="Shipped" {% if order.status=='Shipped' %}selected{% endif %}>Shipped</option>
 <option value="Completed" {% if order.status=='Completed' %}selected{% endif %}>Completed</option>
 <option value="Cancelled" {% if order.status=='Cancelled' %}selected{% endif %}>Cancelled</option>
 </select>
 <div class="input-group-append">
 <button class="btn btn-sm btn-primary" type="submit">Update</button>
 </div>
 </div>
 </form>
 </td>
 <td>{{ order.timestamp.strftime('%Y-%m-%d %H:%M') if order.timestamp else '' }}</td>
 </tr>
 {% endfor %}
 </tbody>
 </table>
 {% else %}
 <p class="text-muted">No orders have been placed yet.</p>
 {% endif %}
 </div>

 <!-- Bootstrap JS for interactive components -->
 <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
